<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Component Vulnerability Analysis - Finite State Report</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        .container {
            margin: 0 auto;
            padding: 20px;
            background-color: white;
            border: 1px solid #dee2e6;
            min-height: 100%;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .logo-container {
            margin-bottom: 20px;
        }
        
        .company-logo {
            max-height: 50px;
            width: auto;
            margin: 0 auto;
            display: block;
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #6c757d;
            font-size: 1.1em;
        }
        
        .metadata {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 30px;
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }
        
        .chart-wrapper {
            position: relative;
            height: 500px;
            margin: 20px 0;
        }
        
        .chart-title {
            color: #2c3e50;
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        
        .chart-description {
            color: #6c757d;
            font-size: 0.95em;
            margin-bottom: 20px;
        }
        
        .narrative-section {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }
        
        .narrative-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .narrative-section h4 {
            color: #495057;
            margin: 20px 0 10px 0;
        }
        
        .narrative-section ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .narrative-section li {
            margin-bottom: 8px;
        }
        
        .table-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            min-width: 600px;
            table-layout: fixed;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: 300px;
            min-width: 100px;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #495057;
            z-index: 10;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            color: #6c757d;
            font-size: 0.9em;
        }
        
        .finite-state-logo {
            color: #007bff;
            font-weight: bold;
        }
        
        .severity-critical { color: #dc3545; font-weight: bold; }
        .severity-high { color: #fd7e14; font-weight: bold; }
        .severity-medium { color: #ffc107; font-weight: bold; }
        .severity-low { color: #28a745; font-weight: bold; }
        
        .kev-marker { color: #dc3545; }
        .exploit-marker { color: #6f42c1; }
        
        .no-data {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 40px;
        }
        
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #f5c6cb;
        }
        
        @media print {
            body {
                background-color: white;
            }
            
            .container {
                max-width: none;
            }
            
            .chart-container, .narrative-section, .table-container {
                border: 1px solid #dee2e6;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            
            <div class="logo-container">
                <img src="data:image/webp;base64,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"
                     alt="Finite State Logo"
                     class="company-logo">
            </div>
            
            <h1>Component Vulnerability Analysis</h1>
            <div class="subtitle">Finite State Security Report</div>
        </div>
        
        <div class="metadata">
            <strong>Report:</strong> Component Vulnerability Analysis | 
            <strong>Generated:</strong> 2026-02-25 21:29:07 UTC | 
            
            <strong>Period:</strong> 2025-11-27 to 2026-02-25 | 
            
            <strong>Records:</strong> N/A
        </div>
        
        <!-- Charts Section -->
        
            <!-- 1. Pareto Chart - Top Risk Components -->
            
            <div class="chart-container">
                <h2 class="chart-title">ðŸ”¢ Top Risk Components - Pareto Analysis</h2>
                <p class="chart-description">Components sorted by composite risk score with cumulative risk percentage. Shows which components contribute disproportionately to total risk.</p>
                <div class="chart-wrapper">
                    <canvas id="paretoChart"></canvas>
                </div>
            </div>
            

            <!-- 2. Bubble Matrix - Scope vs Severity -->
            
            <div class="chart-container">
                <h2 class="chart-title">ðŸŽ¯ Component Risk vs Project Scope</h2>
                <p class="chart-description">Bubble chart showing risk score vs number of affected projects. Bubble size represents finding count.</p>
                <div class="chart-wrapper">
                    <canvas id="bubbleMatrixChart"></canvas>
                </div>
            </div>
            




        

        <div class="narrative-section">
            <h3>Executive Summary</h3>
            <p>The Component Vulnerability Analysis provides a strategic portfolio-level view of the most problematic components across your entire organization. This report identifies which component versions pose the highest risk and have the broadest impact, enabling portfolio-wide component risk prioritization.</p>
            
            <h4>Key Insights from Visualizations</h4>
            <ul>
                <li><strong>Pareto Analysis</strong>: Shows which components contribute disproportionately to total risk, with each version treated uniquely for precise risk assessment.</li>
                <li><strong>Risk vs. Scope</strong>: Identifies components with both high risk and broad project impact for maximum remediation efficiency.</li>
                <li><strong>Normalized Risk Scoring</strong>: Risk scores are normalized by project count to provide fair comparison across components used in different numbers of projects.</li>
            </ul>
            
            <h4>Strategic Recommendations</h4>
            <ul>
                <li><strong>High-Risk Components</strong>: Focus immediate remediation efforts on components with the highest normalized risk scores.</li>
                <li><strong>High-Impact Components</strong>: Prioritize components affecting multiple projects for maximum portfolio-wide risk reduction.</li>
                <li><strong>KEV and Exploit Flags</strong>: Components with ðŸ”’ (KEV) or ðŸ’¥ (exploit) markers require immediate attention due to federal guidance and active threats.</li>
                <li><strong>Portfolio Management</strong>: Use this report to inform strategic component selection and vendor partnerships.</li>
            </ul>
        </div>



        <!-- Portfolio-Level Component Risk Data -->
        
        <div class="table-container">
            <h2>Portfolio-Level Component Risk Data</h2>
            <table>
                <thead>
                    <tr>
                        <th>Component Name</th>
                        <th>Version</th>
                        <th>Projects Affected</th>
                        <th>Portfolio Composite Risk</th>
                        <th>Normalized Risk Score</th>
                        <th>Findings Count</th>
                        <th>Has KEV</th>
                        <th>Has Exploits</th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <td>Linux</td>
                        <td>2.4.36</td>
                        <td>1</td>
                        <td class="severity-critical">186298</td>
                        <td class="severity-critical">186298</td>
                        <td>3228</td>
                        <td>ðŸ”’</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>Linux</td>
                        <td>6.6.73</td>
                        <td>1</td>
                        <td class="severity-critical">103316</td>
                        <td class="severity-critical">103316</td>
                        <td>2118</td>
                        <td>ðŸ”’</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>openwrt/libc</td>
                        <td>1.2.5-r4</td>
                        <td>1</td>
                        <td class="severity-critical">6847</td>
                        <td class="severity-critical">6847</td>
                        <td>93</td>
                        <td>-</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>openwrt/busybox</td>
                        <td>1.36.1-r2</td>
                        <td>1</td>
                        <td class="severity-critical">416</td>
                        <td class="severity-critical">416</td>
                        <td>7</td>
                        <td>-</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>BusyBox</td>
                        <td>1.35.0</td>
                        <td>1</td>
                        <td class="severity-critical">362</td>
                        <td class="severity-critical">362</td>
                        <td>5</td>
                        <td>-</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>binutils</td>
                        <td>2.42</td>
                        <td>1</td>
                        <td class="severity-critical">271</td>
                        <td class="severity-critical">271</td>
                        <td>3</td>
                        <td>-</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>OpenWrt</td>
                        <td>24.10.0</td>
                        <td>1</td>
                        <td class="severity-high">166</td>
                        <td class="severity-high">166</td>
                        <td>2</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                    <tr>
                        <td>alpine/zlib</td>
                        <td>1.3.1-r2</td>
                        <td>1</td>
                        <td class="severity-high">138</td>
                        <td class="severity-high">138</td>
                        <td>1</td>
                        <td>-</td>
                        <td>ðŸ’¥</td>
                    </tr>
                    
                    <tr>
                        <td>openwrt/ppp</td>
                        <td>2.5.1-r1</td>
                        <td>1</td>
                        <td class="severity-medium">93</td>
                        <td class="severity-medium">93</td>
                        <td>1</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                    <tr>
                        <td>alpine/musl</td>
                        <td>1.2.5-r21</td>
                        <td>1</td>
                        <td class="severity-medium">84</td>
                        <td class="severity-medium">84</td>
                        <td>1</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                    <tr>
                        <td>alpine/musl-utils</td>
                        <td>1.2.5-r21</td>
                        <td>1</td>
                        <td class="severity-medium">84</td>
                        <td class="severity-medium">84</td>
                        <td>1</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                    <tr>
                        <td>openwrt/luci-mod-admin-full</td>
                        <td>19.253.48496~3f93650</td>
                        <td>1</td>
                        <td class="severity-medium">61</td>
                        <td class="severity-medium">61</td>
                        <td>1</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                    <tr>
                        <td>alpine/busybox</td>
                        <td>1.37.0-r29</td>
                        <td>1</td>
                        <td class="severity-medium">58</td>
                        <td class="severity-medium">58</td>
                        <td>2</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                    <tr>
                        <td>openwrt/dropbear</td>
                        <td>2024.86-r1</td>
                        <td>1</td>
                        <td class="severity-low">45</td>
                        <td class="severity-low">45</td>
                        <td>1</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    
                </tbody>
            </table>
        </div>
        

        <div class="footer">
            <p>Generated by <span class="finite-state-logo">Finite State</span> | 2026-02-25 21:29:07 UTC</p>
            <p style="font-size: 0.8em; margin-top: 4px;">Copyright &copy; 2026 Finite State, Inc.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Comprehensive color palette for broad analysis
            const colors = {
                primary: '#2E86AB',      // Ocean Blue
                secondary: '#A23B72',    // Deep Rose
                tertiary: '#F18F01',     // Vibrant Orange
                quaternary: '#C73E1D',   // Rich Red
                quinary: '#8B5A2B',      // Saddle Brown
                senary: '#228B22',       // Forest Green
                septenary: '#9370DB',    // Medium Purple
                octonary: '#FF6347',     // Tomato Red
                nonary: '#20B2AA',       // Light Sea Green
                denary: '#FFD700',       // Gold
                eleventh: '#DC143C',     // Crimson
                twelfth: '#32CD32',      // Lime Green
                thirteenth: '#FF69B4',   // Hot Pink
                fourteenth: '#4169E1',   // Royal Blue
                fifteenth: '#FF4500'     // Orange Red
            };

            // Helper function to safely parse JSON
            function safeParseJSON(jsonString, fallback = {}) {
                try {
                    return JSON.parse(jsonString);
                } catch (e) {
                    console.warn('Failed to parse JSON:', e);
                    return fallback;
                }
            }

            // Helper function to create chart with error handling
            function createChart(canvasId, chartData, chartType = 'bar') {
                const canvas = document.getElementById(canvasId);
                if (!canvas) {
                    console.warn(`Canvas with id '${canvasId}' not found`);
                    return;
                }

                if (!chartData || !chartData.labels || !chartData.datasets) {
                    console.warn(`Invalid chart data for ${canvasId}`);
                    return;
                }

                const ctx = canvas.getContext('2d');
                return new Chart(ctx, {
                    type: chartType,
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        plugins: {
                            title: {
                                display: false
                            },
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Components'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Risk Score'
                                }
                            }
                        }
                    }
                });
            }



            // Create Pareto Chart
            
            const paretoData = safeParseJSON('{"labels": ["Linux (2.4.36)", "Linux (6.6.73)", "openwrt/libc (1.2.5-r4)", "openwrt/busybox (1.36.1-r2)", "BusyBox (1.35.0)", "binutils (2.42)", "OpenWrt (24.10.0)", "alpine/zlib (1.3.1-r2)", "openwrt/ppp (2.5.1-r1)", "alpine/musl (1.2.5-r21)", "alpine/musl-utils (1.2.5-r21)", "openwrt/luci-mod-admin-full (19.253.48496~3f93650)", "alpine/busybox (1.37.0-r29)", "openwrt/dropbear (2024.86-r1)"], "datasets": [{"label": "Composite Risk Score", "data": [186298, 103316, 6847, 416, 362, 271, 166, 138, 93, 84, 84, 61, 58, 45], "backgroundColor": ["hsl(0, 70%, 50%)", "hsl(8.494583848784785, 70%, 50%)", "hsl(47.59888013491391, 70%, 50%)", "hsl(87.95525670597999, 70%, 50%)", "hsl(89.95862410111832, 70%, 50%)", "hsl(94.1302391371998, 70%, 50%)", "hsl(101.19227255072032, 70%, 50%)", "hsl(103.85400650111825, 70%, 50%)", "hsl(109.54036566995164, 70%, 50%)", "hsl(111.00689755721997, 70%, 50%)", "hsl(111.00689755721997, 70%, 50%)", "hsl(115.6167825576206, 70%, 50%)", "hsl(116.34341349864073, 70%, 50%)", "hsl(120, 70%, 50%)"], "borderColor": ["#000000", "#000000", "#FF0000", "#FF0000", "#FF0000", "#FF0000", "hsl(101.19227255072032, 70%, 50%)", "#FF0000", "hsl(109.54036566995164, 70%, 50%)", "hsl(111.00689755721997, 70%, 50%)", "hsl(111.00689755721997, 70%, 50%)", "hsl(115.6167825576206, 70%, 50%)", "hsl(116.34341349864073, 70%, 50%)", "hsl(120, 70%, 50%)"], "borderWidth": 3, "yAxisID": "y"}, {"label": "Cumulative Percentage", "data": [62.46600880501879, 97.10802410147566, 99.40383383796217, 99.54331928419823, 99.6646984465479, 99.75556516753342, 99.81122522540647, 99.85749683978285, 99.8886798842539, 99.91684521474387, 99.94501054523386, 99.96546393999444, 99.98491143009466, 100.0], "type": "line", "borderColor": "#FF6B35", "backgroundColor": "rgba(255, 107, 53, 0.2)", "borderWidth": 3, "pointBackgroundColor": "white", "pointBorderColor": "#FF6B35", "pointRadius": 6, "pointBorderWidth": 2, "yAxisID": "y1"}], "markers": {"kev": [true, true, false, false, false, false, false, false, false, false, false, false, false, false], "exploit": [true, true, true, true, true, true, false, true, false, false, false, false, false, false]}}');
            if (paretoData.labels && paretoData.labels.length > 0) {
                const paretoCtx = document.getElementById('paretoChart');
                if (paretoCtx) {
                    new Chart(paretoCtx.getContext('2d'), {
                        type: 'bar',
                        data: {
                            labels: paretoData.labels,
                            datasets: paretoData.datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            interaction: {
                                mode: 'index',
                                intersect: false,
                            },
                            plugins: {
                                title: { display: false },
                                legend: { 
                                    display: true, 
                                    position: 'top',
                                    labels: {
                                        generateLabels: function(chart) {
                                            return [
                                                {
                                                    text: 'ðŸ”’ðŸ’¥ KEV + Exploit',
                                                    fillStyle: '#ffffff',
                                                    strokeStyle: '#000000',
                                                    lineWidth: 4,
                                                    hidden: false,
                                                    index: 0
                                                },
                                                {
                                                    text: 'ðŸ’¥ Has Exploit',
                                                    fillStyle: '#ffffff',
                                                    strokeStyle: '#FF0000',
                                                    lineWidth: 3,
                                                    hidden: false,
                                                    index: 1
                                                },
                                                {
                                                    text: 'Standard Risk',
                                                    fillStyle: '#FFA500',
                                                    strokeStyle: '#FFA500',
                                                    lineWidth: 1,
                                                    hidden: false,
                                                    index: 2
                                                }
                                            ];
                                        }
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        afterLabel: function(context) {
                                            const dataIndex = context.dataIndex;
                                            const kevMarker = paretoData.markers && paretoData.markers.kev && paretoData.markers.kev[dataIndex] ? ' ðŸ”’' : '';
                                            const exploitMarker = paretoData.markers && paretoData.markers.exploit && paretoData.markers.exploit[dataIndex] ? ' ðŸ’¥' : '';
                                            return kevMarker + exploitMarker;
                                        }
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    title: { display: true, text: 'Components (sorted by risk)' }
                                },
                                y: {
                                    type: 'logarithmic',
                                    display: true,
                                    position: 'left',
                                    title: { display: true, text: 'Composite Risk Score (log scale)' },
                                    min: 1
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: { display: true, text: 'Cumulative Percentage (%)' },
                                    grid: { drawOnChartArea: false },
                                    min: 0,
                                    max: 100
                                }
                            },
                            elements: {
                                bar: {
                                    z: 1
                                },
                                line: {
                                    z: 2
                                },
                                point: {
                                    z: 3
                                }
                            }
                        }
                    });
                }
            }
            

            // Create Bubble Matrix Chart
            
            const bubbleData = safeParseJSON('{"data": [{"x": 186298, "y": 1, "r": 50.0, "component": "Linux (2.4.36)", "findingCount": 3228, "hasExploit": true, "inKev": true}, {"x": 103316, "y": 1, "r": 36.24109079640533, "component": "Linux (6.6.73)", "findingCount": 2118, "hasExploit": true, "inKev": true}, {"x": 6847, "y": 1, "r": 11.140378060117756, "component": "openwrt/libc (1.2.5-r4)", "findingCount": 93, "hasExploit": true, "inKev": false}, {"x": 416, "y": 1, "r": 10.074372482181593, "component": "openwrt/busybox (1.36.1-r2)", "findingCount": 7, "hasExploit": true, "inKev": false}, {"x": 362, "y": 1, "r": 10.049581654787728, "component": "BusyBox (1.35.0)", "findingCount": 5, "hasExploit": true, "inKev": false}, {"x": 271, "y": 1, "r": 10.024790827393865, "component": "binutils (2.42)", "findingCount": 3, "hasExploit": true, "inKev": false}, {"x": 166, "y": 1, "r": 10.012395413696932, "component": "OpenWrt (24.10.0)", "findingCount": 2, "hasExploit": false, "inKev": false}, {"x": 138, "y": 1, "r": 10.0, "component": "alpine/zlib (1.3.1-r2)", "findingCount": 1, "hasExploit": true, "inKev": false}, {"x": 93, "y": 1, "r": 10.0, "component": "openwrt/ppp (2.5.1-r1)", "findingCount": 1, "hasExploit": false, "inKev": false}, {"x": 84, "y": 1, "r": 10.0, "component": "alpine/musl (1.2.5-r21)", "findingCount": 1, "hasExploit": false, "inKev": false}, {"x": 84, "y": 1, "r": 10.0, "component": "alpine/musl-utils (1.2.5-r21)", "findingCount": 1, "hasExploit": false, "inKev": false}, {"x": 61, "y": 1, "r": 10.0, "component": "openwrt/luci-mod-admin-full (19.253.48496~3f93650)", "findingCount": 1, "hasExploit": false, "inKev": false}, {"x": 58, "y": 1, "r": 10.012395413696932, "component": "alpine/busybox (1.37.0-r29)", "findingCount": 2, "hasExploit": false, "inKev": false}, {"x": 45, "y": 1, "r": 10.0, "component": "openwrt/dropbear (2024.86-r1)", "findingCount": 1, "hasExploit": false, "inKev": false}]}');
            if (bubbleData.data && bubbleData.data.length > 0) {
                const bubbleCtx = document.getElementById('bubbleMatrixChart');
                if (bubbleCtx) {
                    // Find max risk score for relative coloring
                    const maxRiskScore = Math.max(...bubbleData.data.map(p => p.x));
                    const minRiskScore = Math.min(...bubbleData.data.map(p => p.x));
                    
                    // Create datasets with visual indicators and relative coloring
                    const datasets = [];
                    const allPoints = bubbleData.data;
                    
                    // Group by pattern type
                    const exploitOnlyPoints = allPoints.filter(p => !p.inKev && p.hasExploit);
                    const bothPoints = allPoints.filter(p => p.inKev && p.hasExploit);
                    const normalPoints = allPoints.filter(p => !p.inKev && !p.hasExploit);
                    
                    // Helper function to get color based on risk ratio using log scale
                    function getRiskColor(riskScore, maxRisk, minRisk) {
                        // Use logarithmic scale for color mapping to match the axis
                        const logMin = Math.log(Math.max(1, minRisk));
                        const logMax = Math.log(Math.max(1, maxRisk));
                        const logValue = Math.log(Math.max(1, riskScore));
                        const range = logMax - logMin;
                        const ratio = range > 0 ? Math.max(0, Math.min(1, (logValue - logMin) / range)) : 0;
                        return `hsl(${120 - ratio * 120}, 70%, 50%)`; // Green to red
                    }
                    
                    // Add datasets with visual indicators
                    if (exploitOnlyPoints.length > 0) {
                        datasets.push({
                            label: 'ðŸ’¥ Has Exploit',
                            data: exploitOnlyPoints,
                            backgroundColor: exploitOnlyPoints.map(p => getRiskColor(p.x, maxRiskScore, minRiskScore)),
                            borderColor: '#FF0000',
                            borderWidth: 3,
                            fill: true
                        });
                    }
                    
                    if (bothPoints.length > 0) {
                        datasets.push({
                            label: 'ðŸ”’ðŸ’¥ KEV + Exploit',
                            data: bothPoints,
                            backgroundColor: bothPoints.map(p => getRiskColor(p.x, maxRiskScore, minRiskScore)),
                            borderColor: '#000000',
                            borderWidth: 4,
                            fill: true
                        });
                    }
                    
                    if (normalPoints.length > 0) {
                        datasets.push({
                            label: 'Standard Risk',
                            data: normalPoints,
                            backgroundColor: normalPoints.map(p => getRiskColor(p.x, maxRiskScore, minRiskScore)),
                            borderColor: normalPoints.map(p => getRiskColor(p.x, maxRiskScore, minRiskScore)),
                            borderWidth: 1,
                            fill: true
                        });
                    }
                    
                    // Find top N by risk score for labeling
                    const N = 10;
                    const topPoints = [...allPoints].sort((a, b) => b.x - a.x).slice(0, N);
                    
                    // Compute y max for headroom
                    const maxY = Math.max(...allPoints.map(p => p.y));
                    const yMax = Math.ceil(maxY + 1);
                    
                    new Chart(bubbleCtx.getContext('2d'), {
                        type: 'bubble',
                        data: { datasets: datasets },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                title: { display: false },
                                legend: { 
                                    display: true, 
                                    position: 'top',
                                    labels: {
                                        generateLabels: function(chart) {
                                            const datasets = chart.data.datasets;
                                            return datasets.map((dataset, i) => {
                                                const isExploit = dataset.label.includes('ðŸ’¥') && !dataset.label.includes('ðŸ”’');
                                                const isBoth = dataset.label.includes('ðŸ”’ðŸ’¥');
                                                const isStandard = dataset.label === 'Standard Risk';
                                                
                                                return {
                                                    text: dataset.label,
                                                    fillStyle: isStandard ? '#FFA500' : 
                                                             (isExploit || isBoth) ? '#ffffff' : 
                                                             (dataset.backgroundColor[0] || dataset.backgroundColor),
                                                    strokeStyle: isBoth ? '#000000' : 
                                                                isExploit ? '#FF0000' : 
                                                                (dataset.borderColor[0] || dataset.borderColor),
                                                    lineWidth: isBoth ? 4 : 
                                                              isExploit ? 3 : 
                                                              (dataset.borderWidth || 1),
                                                    hidden: !chart.isDatasetVisible(i),
                                                    index: i
                                                };
                                            });
                                        }
                                    }
                                },
                                tooltip: {
                                    callbacks: {
                                        label: function(context) {
                                            const point = context.raw;
                                            let label = [
                                                `Component: ${point.component}`,
                                                `Risk Score: ${point.x.toLocaleString()}`,
                                                `Projects Affected: ${point.y}`,
                                                `Finding Count: ${point.findingCount}`
                                            ];
                                            if (point.hasExploit && point.inKev) label.push('ðŸ”’ðŸ’¥ KEV + Exploit');
                                            else if (point.hasExploit) label.push('ðŸ’¥ Has Known Exploit');
                                            else if (point.inKev) label.push('ðŸ”’ In KEV');
                                            return label.filter(Boolean);
                                        }
                                    }
                                },
                                datalabels: {
                                    display: function(context) {
                                        const point = context.raw;
                                        return topPoints.includes(point);
                                    },
                                    align: 'top',
                                    anchor: 'end',
                                    font: { weight: 'bold', size: 10 },
                                    color: '#222',
                                    backgroundColor: 'rgba(255,255,255,0.7)',
                                    borderRadius: 4,
                                    padding: 2,
                                    formatter: function(value, context) {
                                        let name = value.component || '';
                                        if (name.length > 18) name = name.slice(0, 15) + '...';
                                        return name;
                                    }
                                }
                            },
                            scales: {
                                x: {
                                    type: 'logarithmic',
                                    title: { display: true, text: 'Composite Risk Score (log scale)' },
                                    min: Math.max(1, minRiskScore * 0.1),
                                    max: maxRiskScore * 1.1
                                },
                                y: {
                                    title: { display: true, text: 'Number of Projects Affected' },
                                    ticks: {
                                        stepSize: 1,
                                        precision: 0
                                    },
                                    min: 0,
                                    max: yMax
                                }
                            }
                        },
                        plugins: [ChartDataLabels]
                    });
                }
            }
            


        });
    </script>
</body>
</html> 